import { sql } from "@vercel/postgres";

const accountSid = process.env.TWILIO_ACCOUNT_SID;
const authToken = process.env.TWILIO_AUTH_TOKEN;

export const config = {
  runtime: "edge"
};

function getMessageForTemplateName(templateName: string): string {
  const templates: Record<string, string> = {
    bhagavad_gita_chapter_1_verse_1: `Bhagavad Gita Chapter 1, Verse 1 sets the stage for the epic conversation between Lord Krishna and Arjuna on the battlefield of Kurukshetra. Dhritarashtra, the blind king, asks his charioteer Sanjaya about the events on the battlefield. He wants to know what his sons, the Kauravas, and the Pandavas, the sons of Pandu, are doing as they prepare for battle. This verse serves as an introduction to the subsequent chapters where Lord Krishna imparts wisdom and guidance to Arjuna, who is torn by moral dilemmas. The dialogue between Lord Krishna and Arjuna forms the essence of the Bhagavad Gita, offering insights into life, duty, righteousness, and spirituality.

рдзреГрддрд░рд╛рд╖реНрдЯреНрд░ рдЙрд╡рд╛рдЪ |
рдзрд░реНрдордХреНрд╖реЗрддреНрд░реЗ рдХреБрд░реБрдХреНрд╖реЗрддреНрд░реЗ рд╕рдорд╡реЗрддрд╛ рдпреБрдпреБрддреНрд╕рд╡рдГ |
рдорд╛рдордХрд╛рдГ рдкрд╛рдгреНрдбрд╡рд╛рд╢реНрдЪреИрд╡ рдХрд┐рдордХреБрд░реНрд╡рдд рд╕рдЮреНрдЬрдп ||
    
Transliteration:
Dhritarashtra Uvacha |
Dharmakshetre Kurukshetre Samaveta Yuyutsavah |
Mamakah Pandavaschaiva Kimakurvata Sanjaya ||`,
    bhagavad_gita_chapter_1_verse_2: `Bhagavad Gita Chapter 1, Verse 2 continues the conversation between Dhritarashtra and Sanjaya. Sanjaya informs Dhritarashtra that after seeing the Pandava army in battle formation, King Duryodhana approaches his teacher, Dronacharya, seeking guidance. This verse sets the stage for the subsequent events in the Bhagavad Gita, where Duryodhana's actions and mindset are contrasted with Arjuna's dilemma and Lord Krishna's teachings on duty, righteousness, and the path to spiritual enlightenment.

рд╕рдЮреНрдЬрдп рдЙрд╡рд╛рдЪ |
рджреГрд╖реНрдЯреНрд╡рд╛ рддреБ рдкрд╛рдгреНрдбрд╡рд╛рдиреАрдХрдВ рд╡реНрдпреВрдврдВ рджреБрд░реНрдпреЛрдзрдирд╕реНрддрджрд╛ |
рдЖрдЪрд╛рд░реНрдпрдореБрдкрд╕рдЩреНрдЧрдореНрдп рд░рд╛рдЬрд╛ рд╡рдЪрдирдордмреНрд░рд╡реАрддреН ||
    
Transliteration:
Sanjaya Uvacha |
Drishtva tu Pandavanikam vyudham Duryodhanas tada |
Acharyam upasangamya raja vachanamabravit ||`,
    bhagavad_gita_chapter_1_verse_3: `Bhagavad Gita Chapter 1, Verse 3:  

In this verse, Duryodhana addresses his teacher, Dronacharya, and draws attention to the mighty army of the Pandavas, led by their intelligent disciple, Dhrishtadyumna, the son of Drupada. Duryodhana acknowledges the strength and organization of the Pandava army, highlighting their formidable presence on the battlefield.

This verse sets the stage for the subsequent chapters, where the dialogue between Lord Krishna and Arjuna unfolds, delving into profound philosophical and spiritual teachings. The Bhagavad Gita explores various aspects of life, duty, righteousness, and the path to self-realization.

рдкрд╢реНрдпреИрддрд╛рдВ рдкрд╛рдгреНрдбреБрдкреБрддреНрд░рд╛рдгрд╛рдорд╛рдЪрд╛рд░реНрдп рдорд╣рддреАрдВ рдЪрдореВрдореН |
рд╡реНрдпреВрдврд╛рдВ рджреНрд░реБрдкрджрдкреБрддреНрд░реЗрдг рддрд╡ рд╢рд┐рд╖реНрдпреЗрдг рдзреАрдорддрд╛ ||

Transliteration:
Pashyaitam Pandu-putranam Acharya mahatim chamoom |
Vyudham drupada-putrena tava shishyena dheemata ||

Have questions about dharma, rituals, yoga, or anything related to Sanatana Dharma? Ask SanatanaDharma.xyz chatbot for guidance.`,
    bhagavad_gita_chapter_1_verse_4: `Bhagavad Gita Chapter 1, Verse 4:

In this verse, Sanjaya describes the Pandava army, led by their valiant warriors, marching forward with great enthusiasm and determination. The army is divinely protected and compared to a great military formation. Dhrishtadyumna, the wise disciple of Dronacharya and son of King Drupada, leads the army.

This verse sets the stage for the epic battle between the Pandavas and the Kauravas. It highlights the strength and determination of the Pandava army, which plays a significant role in the subsequent teachings and discussions presented in the Bhagavad Gita.

рдкрд╛рдгреНрдбрд╡рд╛рдиреАрдХрдВ рджреИрд╡рддреЗрд╖реНрд╡рддреАрд╡ рд╕реЗрдирдВ рдкрд╛рдгреНрдбреБрдкреБрддреНрд░рд╛рдгрд╛рдорд╛рдЪрд╛рд░реНрдп рдорд╣рддреАрдВ рдЪрдореВрдореН |
рд╡реНрдпреВрдврд╛рдВ рджреНрд░реБрдкрджрдкреБрддреНрд░реЗрдг рддрд╡ рд╢рд┐рд╖реНрдпреЗрдг рдзреАрдорддрд╛ ||

Transliteration:
Pandavanikam daivateshvati va senam Panduputranam acharya mahatim chamum |
Vyudham drupadaputrena tava shishyena dheemata ||`,
    bhagavad_gita_chapter_1_verse_3_tamil: `рокроХро╡родрпН роХрпАродрпИ роЕродрпНропро╛ропроорпН 1, рокро╛роЯроорпН 3:

роЗроирпНрод рокро╛роЯродрпНродро┐ро▓рпН, родрпБро░рпНропрпЛродройройрпН родройрпН роЖроЪро╛ро░рпНропро░ро╛рой родрпНро░рпЛрогро╛роЪро╛ро░рпНропро░рпБроХрпНроХрпБ рокрпЗроЪро┐, рокро╛рогрпНроЯро╡ро░рпНроХро│ро┐ройрпН рокро▓роорпБроорпН, роЕро╡ро░рпНроХро│ро╛ро▓рпН родро░ро┐роЪройроорпН роЪрпЖропрпНропрокрпНрокроЯрпБроорпН родро┐ро░ро┐ро╖рпНроЯродрпНропрпБроорпНройройрпН роОройрпНро▒ ро╡ро┐ро╡рпЗроХро┐ропро╛рой роороЯро┐рокрпНрокро╛ро│ро░ро╛рой родро┐ро░рпБрокродройрпН роороХройро╛рой родро┐ро░ро┐ро╖рпНроЯродрпНропрпБроорпНройройрпН роЖроХро┐ропрпЛро░рпИ роХрпБро▒ро┐рокрпНрокро┐роЯрпБроХро┐ро▒ро╛ро░рпН. родрпБро░рпНропрпЛродройройрпН рокро╛рогрпНроЯро╡ро░рпНроХро│ро┐ройрпН рокроЯрпИропро┐ройрпН ро╡ро▓ро┐роорпИропрпИропрпБроорпН, роЕро╡ро░рпНроХро│ро┐ройрпН роЕроорпИрокрпНрокрпИропрпБроорпН роЙрогро░рпНроирпНродрпБ, роЕро╡ро░рпНроХро│ро┐ройрпН рокрпЛро░рпНро╡рпИропрпИ рооро┐роХрпБроирпНродрооро╛роХ роХрпБро▒ро┐рокрпНрокро┐роЯрпБроХро┐ро▒ро╛ро░рпН.

роЗроирпНрод рокро╛роЯроорпН рокро┐ройрпНройро░рпН ро╡роирпНрод роЕродро┐роХро╛ро░роЩрпНроХро│ро┐ро▓рпН, роХро┐ро░рпБро╖рпНрогро╛ роЕро░рпНроЬрпБройройрпБроЯройрпН роироЯроХрпНроХрпБроорпН роЙро░рпИрокрпНрокро╛роЯрпНроЯро┐ройрпН роорпВро▓роорпН, роЖройрпНроорпАроХ рооро▒рпНро▒рпБроорпН родродрпНродрпБро╡ рокро╛роЯроЩрпНроХро│рпИрокрпН рокро▒рпНро▒ро┐ роЖро░ро╛ропрпНроирпНродрпБ роХрпКрогрпНроЯрпБ ро╡ро░рпБроХро┐ройрпНро▒родрпБ. рокроХро╡родрпН роХрпАродрпИ рооройро┐род ро╡ро╛ро┤рпНроХрпНроХрпИропро┐ройрпН ро╡рпЗро▒рпБрокро╛роЯрпБроХро│рпН, роХроЯроорпИроХро│рпН

рдкрд╢реНрдпреИрддрд╛рдВ рдкрд╛рдгреНрдбреБрдкреБрддреНрд░рд╛рдгрд╛рдорд╛рдЪрд╛рд░реНрдп рдорд╣рддреАрдВ рдЪрдореВрдореН |
рд╡реНрдпреВрдврд╛рдВ рджреНрд░реБрдкрджрдкреБрддреНрд░реЗрдг рддрд╡ рд╢рд┐рд╖реНрдпреЗрдг рдзреАрдорддрд╛ ||

Transliteration:
Pashyaitam Pandu-putranam Acharya mahatim chamoom |
Vyudham drupada-putrena tava shishyena dheemata ||`,
    bhagavad_gita_chapter_1_verse_4_tamil: `рокроХро╡родрпН роХрпАродрпИ роЕродрпНропро╛ропроорпН 1, рокро╛роЯроорпН 4:

роЗроирпНрод рокродро┐роХроорпН роЪроЮрпНроЪропро╛ рокро╛рогрпНроЯро╡ роЪрпЗройрпИропрпИроХрпН роХрпБро▒ро┐рокрпНрокро┐роЯрпБроХро┐ро▒ро╛ро░рпН. роЕро╡ро░рпНроХро│рпН родрпИро╡родрпНродро╛ро▓рпН рокро╛родрпБроХро╛роХрпНроХрокрпНрокроЯрпНроЯ рооро╣ро╛роЪрпЗройрпИропро╛роХ роЗро░рпБроХрпНроХро┐ройрпНро▒родрпБ. родрпНро░ро┐ро╖рпНроЯродрпНропрпБроорпНройро╛, родрпНро░рпЛрогро╛роЪро╛ро░рпНропро░ро┐ройрпН роЮро╛ройрооро╛рой роороЯрпНроЯрпБроорпЗ роЕро▓рпНро▓родрпБ ро░ро╛роЬро╛ родрпНро░рпБрокродройрпН роороХройро╛рой родрпНро░рпБрокродрокрпБродрпНро░ройро╛ройро╡ро░ро╛ро▓рпН роЗроирпНрод роЪрпЗройрпИ родро▓рпИроорпИропро╛роХ роироЯроирпНродрпБроХрпКро│рпНро│рпБроХро┐ройрпНро▒родрпБ.

рдкрд╛рдгреНрдбрд╡рд╛рдиреАрдХрдВ рджреИрд╡рддреЗрд╖реНрд╡рддреАрд╡ рд╕реЗрдирдВ рдкрд╛рдгреНрдбреБрдкреБрддреНрд░рд╛рдгрд╛рдорд╛рдЪрд╛рд░реНрдп рдорд╣рддреАрдВ рдЪрдореВрдореН |
рд╡реНрдпреВрдврд╛рдВ рджреНрд░реБрдкрджрдкреБрддреНрд░реЗрдг рддрд╡ рд╢рд┐рд╖реНрдпреЗрдг рдзреАрдорддрд╛ ||

роТро▓ро┐рокрпЖропро░рпНрокрпНрокрпБ:
рокро╛рогрпНроЯро╡ро╛ройрпАроХроорпН родрпИро╡родрпЗро╖рпНро╡родрпАро╡ роЪрпЗройроорпН рокро╛рогрпНроЯрпБрокрпБродрпНро░ро╛рогро╛рооро╛роЪро╛ро░рпНроп рооро╣родрпАроорпН роЪроорпВроорпН |
ро╡рпНропрпВродро╛роорпН родрпНро░рпБрокродрокрпБродрпНро░рпЗрог родро╡ роЪро┐ро╖рпНропрпЗрог родрпАроородро╛ ||`,
    bhagavad_gita_chapter_1_verse_5: `Bhagavad Gita Chapter 1, Verse 5

In this verse, Sanjaya describes the Pandava army, divinely protected and led by valiant warriors. The formation, called "Pandavanikam," is compared to a great army. Dhrishtadyumna, the wise disciple of Dronacharya and son of King Drupada, leads the army. This verse sets the stage for the epic battle between the Pandavas and Kauravas, highlighting the strength and determination of the Pandava army. It signifies the beginning of the moral dilemmas faced by Arjuna, leading to Lord Krishna's teachings in the subsequent chapters of the Bhagavad Gita.

рдкрд╛рдгреНрдбрд╡рд╛рдиреАрдХрдВ рджреИрд╡рддреЗрд╖реНрд╡рддреАрд╡ рд╕реЗрдирдВ рдкрд╛рдгреНрдбреБрдкреБрддреНрд░рд╛рдгрд╛рдорд╛рдЪрд╛рд░реНрдп рдорд╣рддреАрдВ рдЪрдореВрдореН |
рд╡реНрдпреВрдврд╛рдВ рджреНрд░реБрдкрджрдкреБрддреНрд░реЗрдг рддрд╡ рд╢рд┐рд╖реНрдпреЗрдг рдзреАрдорддрд╛ ||

Transliteration:
P─Бс╣Зс╕Нav─Бn─лkaс╣Б daivateс╣гvat─лva senaс╣Б p─Бс╣Зс╕Нuputr─Бс╣З─Бm ─Бc─Бrya mahat─лс╣Б cham┼лm |
Vy┼лс╕Нh─Бс╣Б drupadaputreс╣Зa tava ┼Ыiс╣гyeс╣Зa dh─лmat─Б ||`,
    ganapati_welcome: `ЁЯЩП Om Gam Ganapataye Namaha ЁЯРШ
    
On this auspicious day, let us begin our journey by offering our heartfelt prayers to Lord Ganapati, the remover of obstacles and the embodiment of wisdom. May his divine presence guide us on this path of exploration and discovery. ЁЯЩП

Let's dive into the ocean of knowledge and wisdom that Sanatana Dharma offers. From the Vedas to the Bhagavad Gita, yoga to meditation, there is much to explore.

Remember the power of sacred mantras. One such mantra is \"реР рдЧрдВ рдЧрдгрдкрддрдпреЗ рдирдордГ\" (Om Gam Ganapataye Namaha). Chant it with devotion to seek Lord Ganapati's blessings and overcome challenges.

Have questions about dharma, rituals, yoga, or anything related to Sanatana Dharma? Ask SanatanaDharma.xyz chatbot for guidance.

Embrace this journey with an open mind. May it bring us closer to our true selves and lead us to a life filled with purpose, peace, and spiritual growth.`,
    reply_first_message: "Namaste ЁЯЩП Welcome to the sacred journey with SanatanaDharma.xyz. You're now subscribed to receive one verse a day from the Bhagavad Gita, Vedas, Upanishads. Let the transformation begin! Please reply with \"yes\" or \"subscribe\" to receive daily messages.",
    namaste_with_book_intro: "Welcome to the enlightening journey! You're now subscribed to receive one verse a day from the Bhagavad Gita, Vedas, Upanishads. Let the transformation begin! ЁЯЩПЁЯУЦтЬи",
    namaste_first_message: "Namaste ЁЯЩП Welcome to the sacred journey with SanatanaDharma.xyz. You're now subscribed to receive one verse a day from the Bhagavad Gita, Vedas, Upanishads. Let the transformation begin!",
    first_message_on_subscription: "Welcome to the enlightening journey! You're now subscribed with SanatanaDharma.xyz to receive one verse a day from the Bhagavad Gita, Vedas, Upanishads. Let the transformation begin!",
    bhagavad_gita_chapter_1_verse_6	: `Bhagavad Gita Chapter 1, Verse 6:

рдпреБрдзрд╛рдордиреНрдпреБрд╢реНрдЪ рд╡рд┐рдХреНрд░рд╛рдиреНрдд рдЙрддреНрддрдореМрдЬрд╛рд╢реНрдЪ рд╡реАрд░реНрдпрд╡рд╛рдиреНред 
рд╕реМрднрджреНрд░реЛ рджреНрд░реМрдкрджреЗрдпрд╛рд╢реНрдЪ рд╕рд░реНрд╡ рдПрд╡ рдорд╣рд╛рд░рдерд╛рдГредред1.6редред

saubhadro draupadey─Б┼Ыhcha sarva eva mah─Б-rath─Бс╕е

saubhadraс╕етАФthe son of Subhadra; draupadey─Бс╕етАФthe sons of Draupadi; chaтАФand; sarveтАФall; evaтАФindeed; mah─Б-rath─Бс╕етАФwarriors who could single handedly match the strength of ten thousand ordinary warriors

Translation:
The strong Yudhamanyu and the brave Uttamaujas, the son of Subhadra (Abhimanyu, the son of Subhadra and Arjuna), and the sons of Draupadi, all of them are great charioteers (great heroes).
`,
    bhagavad_gita_chapter_1_verse_7: `Bhagavad Gita Chapter 1 v7
рдЕрд╕реНрдорд╛рдХрдВ рддреБ рд╡рд┐рд╢рд┐рд╖реНрдЯрд╛ рдпреЗ рддрд╛рдиреНрдирд┐рдмреЛрдз рджреНрд╡рд┐рдЬреЛрддреНрддрдоред 
рдирд╛рдпрдХрд╛ рдордо рд╕реИрдиреНрдпрд╕реНрдп рд╕рдВрдЬреНрдЮрд╛рд░реНрдердВ рддрд╛рдиреНрдмреНрд░рд╡реАрдорд┐ рддреЗред

asm─Бkaс╣Б tu vi┼Ыhiс╣гhс╣н─Б ye t─Бnnibodha dwijottama n─Бyak─Б 
mama sainyasya sanj├▒─Бrthaс╣Б t─Бnbrav─лmi te

In this verse, Sanjaya describes the actions of Dronacharya, the preeminent teacher and commander of the Kaurava army. Dronacharya is leading the Kaurava formation, which is compared to a mighty army formation, much like the one described in the previous verse for the Pandavas. He is being guided and supported by his wise disciple, Dhrishtadyumna, who is the son of King Drupada.

The verse highlights the pivotal role of Dronacharya as a teacher and commander. His expertise in warfare and his strategic skills are emphasized as he prepares the Kaurava forces for battle. The term "m─Бtparaс╣Б" suggests that Dronacharya was dedicated to achieving the welfare and victory of the Kauravas. The verse serves to underscore the significance of the respective commanders and their roles in the impending conflict.
`,
    bhagavad_gita_chapter_1_verse_8: `Bhagavad Gita Chapter 1, Verse 8:

Verse (Sanskrit):
рднрд╡рд╛рдиреНрднреАрд╖реНрдорд╢реНрдЪ рдХрд░реНрдгрд╢реНрдЪ рдХреГрдкрд╢реНрдЪ рд╕рдорд┐рддрд┐рдЮреНрдЬрдпрдГред 
рдЕрд╢реНрд╡рддреНрдерд╛рдорд╛ рд╡рд┐рдХрд░реНрдгрд╢реНрдЪ рд╕реМрдорджрддреНрддрд┐рд╕реНрддрдереИрд╡ рдЪредред1.8редред

bhav─Бnbh─лс╣гhma┼Ыhcha karс╣Зa┼Ыhcha kс╣Ыipa┼Ыhcha samiti├▒jayaс╕е 
a┼Ыhvatth─Бm─Б vikarс╣Зa┼Ыhcha saumadattis tathaiva cha

bhav─БnтАФyourself; bh─лс╣гhmaс╕етАФBheeshma; chaтАФand; karс╣Зaс╕етАФKarna; chaтАФand; kс╣Ыipaс╕етАФKripa; chaтАФand; samitim-jayaс╕етАФvictorious in battle; a┼Ыhvatth─Бm─БтАФAshvatthama; vikarс╣Зaс╕етАФVikarna; chaтАФand; saumadattiс╕етАФBhurishrava; tath─БтАФthus; evaтАФeven; chaтАФalso

Translation
"Thou thyself, Bhishma, Karna, Kripa, the victorious in war, Asvatthama, Vikarna, and Bhurisrava, the son of SomadattaтАФall these are ready for battle."
`,
    bhagavad_gita_chapter_1_verse_9: `Bhagavad Gita Chapter 1, Verse 9:

рдЕрдиреНрдпреЗ рдЪ рдмрд╣рд╡рдГ рд╢реВрд░рд╛ рдорджрд░реНрдереЗ рддреНрдпрдХреНрддрдЬреАрд╡рд┐рддрд╛рдГред 
рдирд╛рдирд╛рд╢рд╕реНрддреНрд░рдкреНрд░рд╣рд░рдгрд╛рдГ рд╕рд░реНрд╡реЗ рдпреБрджреНрдзрд╡рд┐рд╢рд╛рд░рджрд╛рдГредред1.9редред

anye cha bahavaс╕е ┼Ыh┼лr─Б madarthe tyaktaj─лvit─Бс╕е n─Бn─Б-┼Ыhastra-praharaс╣З─Бс╕е sarve yuddha-vi┼Ыh─Бrad─Бс╕е

anyeтАФothers; chaтАФalso; bahavaс╕етАФmany; ┼Ыh┼лr─Бс╕етАФheroic warriors; mat-artheтАФfor my sake; tyakta-j─лvit─Бс╕етАФprepared to lay down their lives; n─Бn─Б-┼Ыhastra-praharaс╣З─Бс╕етАФequipped with various kinds of weapons; sarveтАФall; yuddha-vi┼Ыh─Бrad─Бс╕етАФskilled in the art of warfare

Translation
And also many other heroes, ready to give up their lives for my sake, armed with various weapons and missiles, all well-skilled in battle.
`,
    bhagavad_gita_chapter_1_verse_10: `Bhagavad Gita Chapter 1, Verse 10:

рдЕрдкрд░реНрдпрд╛рдкреНрддрдВ рддрджрд╕реНрдорд╛рдХрдВ рдмрд▓рдВ рднреАрд╖реНрдорд╛рднрд┐рд░рдХреНрд╖рд┐рддрдореНред 
рдкрд░реНрдпрд╛рдкреНрддрдВ рддреНрд╡рд┐рджрдореЗрддреЗрд╖рд╛рдВ рдмрд▓рдВ рднреАрдорд╛рднрд┐рд░рдХреНрд╖рд┐рддрдореНредред1.10редред

apary─Бptaс╣Б tadasm─Бkaс╣Б balaс╣Б bh─лс╣гhm─Бbhirakс╣гhitam 
pary─Бptaс╣Б tvidameteс╣гh─Бс╣Б balaс╣Б bh─лm─Бbhirakс╣гhitam

apary─БptamтАФunlimited; tatтАФthat; asm─БkamтАФours; balamтАФstrength; bh─лс╣гhmaтАФby Grandsire Bheeshma; abhirakс╣гhitamтАФsafely marshalled; pary─БptamтАФlimited; tuтАФbut; idamтАФthis; eteс╣гh─БmтАФtheir; balamтАФstrength; bh─лmaтАФBheem; abhirakс╣гhitamтАФcarefully marshalled

Translation
Our army, marshalled by Bhishma, is insufficient, whereas theirs, marshalled by Bhima, is sufficient.
`,
    bhagavad_gita_chapter_1_verse_11: `Bhagavad Gita Chapter 1, Verse 11:

рдЕрдпрдиреЗрд╖реБ рдЪ рд╕рд░реНрд╡реЗрд╖реБ рдпрдерд╛рднрд╛рдЧрдорд╡рд╕реНрдерд┐рддрд╛рдГред 
рднреАрд╖реНрдордореЗрд╡рд╛рднрд┐рд░рдХреНрд╖рдиреНрддреБ рднрд╡рдиреНрддрдГ рд╕рд░реНрд╡ рдПрд╡ рд╣рд┐редред1.11редред

ayaneс╣гhu cha sarveс╣гhu yath─Б-bh─Бgamavasthit─Бс╕е 
bh─лс╣гhmamev─Бbhirakс╣гhantu bhavantaс╕е sarva eva hi

ayaneс╣гhuтАФat the strategic points; chaтАФalso; sarveс╣гhuтАФall; yath─Б-bh─БgamтАФin respective position; avasthit─Бс╕етАФsituated; bh─лс╣гhmamтАФto Grandsire Bheeshma; evaтАФonly; abhirakс╣гhantuтАФdefend; bhavantaс╕етАФyou; sarveтАФall; eva hiтАФeven as

Translation
Therefore, do all of you, stationed in your respective positions in the several divisions of the army, protect Bhishma alone.
`,
    bhagavad_gita_chapter_1_verse_12: `Bhagavad Gita Chapter 1, Verse 12:

рддрд╕реНрдп рд╕рдВрдЬрдирдпрдиреНрд╣рд░реНрд╖рдВ рдХреБрд░реБрд╡реГрджреНрдзрдГ рдкрд┐рддрд╛рдорд╣рдГред рд╕рд┐рдВрд╣рдирд╛рджрдВ рд╡рд┐рдирджреНрдпреЛрдЪреНрдЪреИрдГ рд╢рдЩреНрдЦрдВ рджрдзреНрдореМ рдкреНрд░рддрд╛рдкрд╡рд╛рдиреНредред1.12редред

tasya sa├▒janayan harс╣гhaс╣Б kuru-vс╣Ыiddhaс╕е pit─Бmahaс╕е siс╣Бha-n─Бdaс╣Б vinadyochchaiс╕е ┼Ыhaс╣Еkhaс╣Б dadhmau prat─Бpav─Бn

tasyaтАФhis; sa├▒janayanтАФcausing; harс╣гhamтАФjoy; kuru-vс╣Ыiddhaс╕етАФthe grand old man of the Kuru dynasty (Bheeshma); pit─Бmahaс╕етАФgrandfather; sinha-n─БdamтАФlionтАЩs roar; vinadyaтАФsounding; uchchaiс╕етАФvery loudly; ┼Ыhaс╣ЕkhamтАФconch shell; dadhmauтАФblew; prat─Бpa-v─БnтАФthe glorious

Translation
His glorious grandsire, the oldest of the Kauravas, roared like a lion to cheer Duryodhana and blew his conch.
`,
    bhagavad_gita_chapter_1_verse_13: `Bhagavad Gita Chapter 1, Verse 13:

рддрддрдГ рд╢рдЩреНрдЦрд╛рд╢реНрдЪ рднреЗрд░реНрдпрд╢реНрдЪ рдкрдгрд╡рд╛рдирдХрдЧреЛрдореБрдЦрд╛рдГред 
рд╕рд╣рд╕реИрд╡рд╛рднреНрдпрд╣рдиреНрдпрдиреНрдд рд╕ рд╢рдмреНрджрд╕реНрддреБрдореБрд▓реЛрд╜рднрд╡рддреНредред1.13редред

tataс╕е ┼Ыhaс╣Еkh─Б┼Ыhcha bherya┼Ыhcha paс╣Зav─Бnaka-gomukh─Бс╕е 
sahasaiv─Бbhyahanyanta sa ┼Ыhabdastumulo тАЩbhavat

tataс╕етАФthereafter; ┼Ыhaс╣Еkh─Бс╕етАФconches; chaтАФand; bheryaс╕етАФbugles; chaтАФand; paс╣Зava-─БnakaтАФdrums and kettledrums; go-mukh─Бс╕етАФtrumpets; sahas─БтАФsuddenly; evaтАФindeed; abhyahanyantaтАФblared forth; saс╕етАФthat; ┼Ыhabdaс╕етАФsound; tumulaс╕етАФoverwhelming; abhavatтАФwas

Translation
Then, suddenly, conches, kettledrums, tabors, drums, and cow horns blared forth from the Kaurava side, and the sound was tremendous.
`,
    bhagavad_gita_chapter_1_verse_14: `Bhagavad Gita Chapter 1, Verse 14:

рддрддрдГ рд╢реНрд╡реЗрддреИрд░реНрд╣рдпреИрд░реНрдпреБрдХреНрддреЗ рдорд╣рддрд┐ рд╕реНрдпрдиреНрджрдиреЗ рд╕реНрдерд┐рддреМред 
рдорд╛рдзрд╡рдГ рдкрд╛рдгреНрдбрд╡рд╢реНрдЪреИрд╡ рджрд┐рд╡реНрдпреМ рд╢рдЩреНрдЦреМ рдкреНрд░рджрдзреНрдорддреБрдГредред1.14редред

tataс╕е ┼Ыhvetairhayairyukte mahati syandane sthitau m─Бdhavaс╕е p─Бс╣Зс╕Нava┼Ыhchaiva divyau ┼Ыhaс╣Еkhau pradadhmatuс╕е

tataс╕етАФthen; ┼Ыhvetaiс╕етАФby white; hayaiс╕етАФhorses; yukteтАФyoked; mahatiтАФglorious; syandaneтАФchariot; sthitauтАФseated; m─Бdhavaс╕етАФShree Krishna, the husband of the goddess of fortune, Lakshmi; p─Бс╣Зс╕Нavaс╕етАФArjun; chaтАФand; evaтАФalso; divyauтАФDivine; ┼Ыhaс╣ЕkhauтАФconch shells; pradadhmatuс╕етАФblew

Translation
Then, Madhava (Krishna) and the son of Pandu (Arjuna), seated in the magnificent chariot yoked with white horses, blew divine conches.
`,
    bhagavad_gita_chapter_1_verse_15	: `Bhagavad Gita Chapter 1, Verse 15:

рдкрд╛рдЮреНрдЪрдЬрдиреНрдпрдВ рд╣реГрд╖реАрдХреЗрд╢реЛ рджреЗрд╡рджрддреНрддрдВ рдзрдирдВрдЬрдпрдГред 
рдкреМрдгреНрдбреНрд░рдВ рджрдзреНрдореМ рдорд╣рд╛рд╢рдЩреНрдЦрдВ рднреАрдордХрд░реНрдорд╛ рд╡реГрдХреЛрджрд░рдГредред1.15редред

p─Б├▒chajanyaс╣Б hс╣Ыiс╣гh─лke┼Ыho devadattaс╣Б dhana├▒jayaс╕е 
pauс╣Зс╕Нraс╣Б dadhmau mah─Б-┼Ыhaс╣Еkhaс╣Б bh─лma-karm─Б vс╣Ыikodaraс╕е

p─Б├▒chajanyamтАФthe conch shell named Panchajanya; hс╣Ыiс╣гh─лka-─л┼Ыhaс╕етАФShree Krishna, the Lord of the mind and senses; devadattamтАФthe conch shell named Devadutta; dhanam-jayaс╕етАФArjun, the winner of wealth; pauс╣Зс╕НramтАФthe conch named Paundra; dadhmauтАФblew; mah─Б-┼Ыhaс╣ЕkhamтАФmighty conch; bh─лma-karm─БтАФone who performs herculean tasks; vс╣Ыika-udaraс╕етАФBheem, the voracious eater

Translation
Hrishikesha blew the Panchajanya, Arjuna blew the Devadatta, and Bhima, the wolf-bellied doer of terrible deeds, blew the great conch Paundra.
`,
    bhagavad_gita_chapter_1_verse_16: `Bhagavad Gita Chapter 1, Verse 16:

рдЕрдирдиреНрддрд╡рд┐рдЬрдпрдВ рд░рд╛рдЬрд╛ рдХреБрдиреНрддреАрдкреБрддреНрд░реЛ рдпреБрдзрд┐рд╖реНрдард┐рд░рдГред рдирдХреБрд▓рдГ рд╕рд╣рджреЗрд╡рд╢реНрдЪ рд╕реБрдШреЛрд╖рдордгрд┐рдкреБрд╖реНрдкрдХреМредред1.16редред

anantavijayaс╣Б r─Бj─Б kunt─л-putro yudhiс╣гhс╣нhiraс╕е nakulaс╕е sahadeva┼Ыhcha sughoс╣гha-maс╣Зipuс╣гhpakau

ananta-vijayamтАФthe conch named Anantavijay; r─Бj─БтАФking; kunt─л-putraс╕етАФson of Kunti; yudhiс╣гhс╣нhiraс╕етАФYudhishthir; nakulaс╕етАФNakul; sahadevaс╕етАФSahadev; chaтАФand; sughoс╣гha-maс╣Зipuс╣гhpakauтАФthe conche shells named Sughosh and Manipushpak;

Translation
King Yudhishthira, the son of Kunti, blew the Anantavijaya; Nakula and Sahadeva blew the Sughosha and the Manipushpaka.
`,
    bhagavad_gita_chapter_1_verse_17: `Bhagavad Gita Chapter 1, Verse 17:

рдХрд╛рд╢реНрдпрд╢реНрдЪ рдкрд░рдореЗрд╖реНрд╡рд╛рд╕рдГ рд╢рд┐рдЦрдгреНрдбреА рдЪ рдорд╣рд╛рд░рдердГред 
рдзреГрд╖реНрдЯрджреНрдпреБрдореНрдиреЛ рд╡рд┐рд░рд╛рдЯрд╢реНрдЪ рд╕рд╛рддреНрдпрдХрд┐рд╢реНрдЪрд╛рдкрд░рд╛рдЬрд┐рддрдГредред1.17редред

k─Б┼Ыhya┼Ыhcha parameс╣гhv─Бsaс╕е ┼Ыhikhaс╣Зс╕Н─л cha mah─Б-rathaс╕е dhс╣Ыiс╣гhс╣нadyumno vir─Бс╣нa┼Ыhcha s─Бtyaki┼Ыh ch─Бpar─Бjitaс╕е

k─Б┼Ыhyaс╕етАФKing of Kashi; chaтАФand; parama-iс╣гhu-─Бsaс╕етАФthe excellent archer; ┼Ыhikhaс╣Зс╕Н─лтАФShikhandi; chaтАФalso; mah─Б-rathaс╕етАФwarriors who could single handedly match the strength of ten thousand ordinary warriors; dhс╣Ыiс╣гhс╣нadyumnaс╕етАФDhrishtadyumna; vir─Бс╣нaс╕етАФVirat; chaтАФand; s─Бtyakiс╕етАФSatyaki; chaтАФand; apar─Бjitaс╕етАФinvincible;

Translation
The king of Kasi, an excellent archer, Sikhandi, the mighty car-warrior, Dhrishtadyumna, Virata, and Satyaki, the unconquered.
`,
    bhagavad_gita_chapter_1_verse_18: `Bhagavad Gita Chapter 1, Verse 18:

рджреНрд░реБрдкрджреЛ рджреНрд░реМрдкрджреЗрдпрд╛рд╢реНрдЪ рд╕рд░реНрд╡рд╢рдГ рдкреГрдерд┐рд╡реАрдкрддреЗред 
рд╕реМрднрджреНрд░рд╢реНрдЪ рдорд╣рд╛рдмрд╛рд╣реБрдГ рд╢рдЩреНрдЦрд╛рдиреНрджрдзреНрдореБрдГ рдкреГрдердХреНрдкреГрдердХреНредред1.18редред

drupado draupadey─Б┼Ыhcha sarva┼Ыhaс╕е pс╣Ыithiv─л-pate saubhadra┼Ыhcha mah─Б-b─Бhuс╕е ┼Ыhaс╣Еkh─Бndadhmuс╕е pс╣Ыithak pс╣Ыithak

drupadaс╕етАФDrupad; draupadey─Бс╕етАФthe five sons of Draupadi; chaтАФand; sarva┼Ыhaс╕етАФall; pс╣Ыithiv─л-pateтАФRuler of the earth; saubhadraс╕етАФAbhimanyu, the son of Subhadra; chaтАФalso; mah─Б-b─Бhuс╕етАФthe mighty-armed; ┼Ыhaс╣Еkh─БnтАФconch shells; dadhmuс╕етАФblew; pс╣Ыithak pс╣ЫithakтАФindividually

Translation
Drupada and the sons of Draupadi, O Lord of the Earth, and the son of Subhadra, the mighty-armed, blew their conches each separately.
`,
    bhagavad_gita_chapter_1_verse_19: `Bhagavad Gita Chapter 1, Verse 19:

рд╕ рдШреЛрд╖реЛ рдзрд╛рд░реНрддрд░рд╛рд╖реНрдЯреНрд░рд╛рдгрд╛рдВ рд╣реГрджрдпрд╛рдирд┐ рд╡реНрдпрджрд╛рд░рдпрддреНред 
рдирднрд╢реНрдЪ рдкреГрдерд┐рд╡реАрдВ рдЪреИрд╡ рддреБрдореБрд▓реЛ рд╡реНрдпрдиреБрдирд╛рджрдпрдиреНредред1.19редред

sa ghoс╣гho dh─Бrtar─Бс╣гhс╣нr─Бс╣З─Бс╣Б hс╣Ыiday─Бni vyad─Бrayat 
nabha┼Ыhcha pс╣Ыithiv─лс╣Б chaiva tumulo nun─Бdayan

saс╕етАФthat; ghoс╣гhaс╕етАФsound; dh─Бrtar─Бс╣гhс╣нr─Бс╣З─БmтАФof DhritarashtraтАЩs sons; hс╣Ыiday─БniтАФhearts; vyad─БrayatтАФshattered; nabhaс╕етАФthe sky; chaтАФand; pс╣Ыithiv─лmтАФthe earth; chaтАФand; evaтАФcertainly; tumulaс╕етАФterrific sound; abhyanun─БdayanтАФthundering

Translation
The tumultuous sound rent the hearts of Dhritarashtra's party, reverberating through both heaven and earth.
`,
    bhagavad_gita_chapter_1_verse_20: `Bhagavad Gita Chapter 1, Verse 20:

рдЕрде рд╡реНрдпрд╡рд╕реНрдерд┐рддрд╛рдиреНрджреГрд╖реНрдЯреНрд╡рд╛ рдзрд╛рд░реНрддрд░рд╛рд╖реНрдЯреНрд░рд╛рдиреН рдХрдкрд┐рдзреНрд╡рдЬ: |
рдкреНрд░рд╡реГрддреНрддреЗ рд╢рд╕реНрддреНрд░рд╕рдореНрдкрд╛рддреЗ рдзрдиреБрд░реБрджреНрдпрдореНрдп рдкрд╛рдгреНрдбрд╡: ||20||
рд╣реГрд╖реАрдХреЗрд╢рдВ рддрджрд╛ рд╡рд╛рдХреНрдпрдорд┐рджрдорд╛рд╣ рдорд╣реАрдкрддреЗ |

atha vyavasthit─Бn dс╣Ыiс╣гhс╣нv─Б dh─Бrtar─Бс╣гhс╣нr─Бn kapi-dhwajaс╕е 
pravс╣Ыitte ┼Ыhastra-samp─Бte dhanurudyamya p─Бс╣Зс╕Нavaс╕е 
hс╣Ыiс╣гh─лke┼Ыhaс╣Б tad─Б v─Бkyam idam ─Бha mah─л-pate

athaтАФthereupon; vyavasthit─БnтАФarrayed; dс╣Ыiс╣гhс╣нv─БтАФseeing; dh─Бrtar─Бс╣гhс╣нr─БnтАФDhritarashtraтАЩs sons; kapi-dwajaс╕етАФthe Monkey Bannered; pravс╣ЫitteтАФabout to commence; ┼Ыhastra-samp─БteтАФto use the weapons; dhanuс╕етАФbow; udyamyaтАФtaking up; p─Бс╣Зс╕Нavaс╕етАФArjun, the son of Pandu; hс╣Ыiс╣гh─лke┼ЫhamтАФto Shree Krishna; tad─БтАФat that time; v─БkyamтАФwords; idamтАФthese; ─БhaтАФsaid; mah─л-pateтАФKing

Translation
Then, seeing the people of Dhritarashtra's party standing arrayed and the discharge of weapons about to begin, Arjuna, the son of Pandu whose ensign was a monkey, took up his bow and said the following to Krishna, O Lord of the Earth.
`	













  };

  return templates[templateName] || "Template not found.";
}

function getNextTemplate(template_name: string, lang:string) {
  if(lang == 'en') {
    const templates: Record<string, string> = {
      first_message_on_subscription: "ganapati_welcome",
      namaste_first_message: "ganapati_welcome",
      namaste_with_book_intro: "ganapati_welcome",
      reply_first_message: "ganapati_welcome",
      ganapati_welcome: "bhagavad_gita_chapter_1_verse_1",
      bhagavad_gita_chapter_1_verse_1: "bhagavad_gita_chapter_1_verse_2",
      bhagavad_gita_chapter_1_verse_2: "bhagavad_gita_chapter_1_verse_3",
      bhagavad_gita_chapter_1_verse_3: "bhagavad_gita_chapter_1_verse_4",
      bhagavad_gita_chapter_1_verse_4: "bhagavad_gita_chapter_1_verse_5",
      bhagavad_gita_chapter_1_verse_5: "bhagavad_gita_chapter_1_verse_6",
      bhagavad_gita_chapter_1_verse_6: "bhagavad_gita_chapter_1_verse_7",
      bhagavad_gita_chapter_1_verse_7: "bhagavad_gita_chapter_1_verse_8",
      bhagavad_gita_chapter_1_verse_8: "bhagavad_gita_chapter_1_verse_9",
      bhagavad_gita_chapter_1_verse_9: "bhagavad_gita_chapter_1_verse_10",
      bhagavad_gita_chapter_1_verse_10: "bhagavad_gita_chapter_1_verse_11",
      bhagavad_gita_chapter_1_verse_11: "bhagavad_gita_chapter_1_verse_12",
      bhagavad_gita_chapter_1_verse_12: "bhagavad_gita_chapter_1_verse_13",
      bhagavad_gita_chapter_1_verse_13: "bhagavad_gita_chapter_1_verse_14",
      bhagavad_gita_chapter_1_verse_14: "bhagavad_gita_chapter_1_verse_15",
      bhagavad_gita_chapter_1_verse_15: "bhagavad_gita_chapter_1_verse_16",
      bhagavad_gita_chapter_1_verse_16: "bhagavad_gita_chapter_1_verse_17",
      bhagavad_gita_chapter_1_verse_17: "bhagavad_gita_chapter_1_verse_18",
      bhagavad_gita_chapter_1_verse_18: "bhagavad_gita_chapter_1_verse_19",
      bhagavad_gita_chapter_1_verse_19: "bhagavad_gita_chapter_1_verse_20",
      bhagavad_gita_chapter_1_verse_20: "bhagavad_gita_chapter_1_verse_21",
      bhagavad_gita_chapter_1_verse_21: "bhagavad_gita_chapter_1_verse_22",
    };
    return templates[template_name];
  } else if(lang == 'ta') {
    const templates: Record<string, string> = {
      bhagavad_gita_chapter_1_verse_2: "bhagavad_gita_chapter_1_verse_3_tamil",
      bhagavad_gita_chapter_1_verse_3_tamil: "bhagavad_gita_chapter_1_verse_4_tamil",
      bhagavad_gita_chapter_1_verse_4_tamil: "bhagavad_gita_chapter_1_verse_5",
      bhagavad_gita_chapter_1_verse_5: "bhagavad_gita_chapter_1_verse_6",
      bhagavad_gita_chapter_1_verse_7: "bhagavad_gita_chapter_1_verse_8",
      bhagavad_gita_chapter_1_verse_8: "bhagavad_gita_chapter_1_verse_9",
      bhagavad_gita_chapter_1_verse_9: "bhagavad_gita_chapter_1_verse_10",
      bhagavad_gita_chapter_1_verse_10: "bhagavad_gita_chapter_1_verse_11",
      bhagavad_gita_chapter_1_verse_11: "bhagavad_gita_chapter_1_verse_12",
      bhagavad_gita_chapter_1_verse_12: "bhagavad_gita_chapter_1_verse_13",
      bhagavad_gita_chapter_1_verse_13: "bhagavad_gita_chapter_1_verse_14",
      bhagavad_gita_chapter_1_verse_14: "bhagavad_gita_chapter_1_verse_15",
      bhagavad_gita_chapter_1_verse_15: "bhagavad_gita_chapter_1_verse_16",
      bhagavad_gita_chapter_1_verse_16: "bhagavad_gita_chapter_1_verse_17",
      bhagavad_gita_chapter_1_verse_17: "bhagavad_gita_chapter_1_verse_18",
      bhagavad_gita_chapter_1_verse_18: "bhagavad_gita_chapter_1_verse_19",
      bhagavad_gita_chapter_1_verse_19: "bhagavad_gita_chapter_1_verse_20",
    }
    return templates[template_name];
  }
  return "";
}

async function sendNextEmail(email:string, template:string) {
  const response = await fetch("https://sanatanadharma.xyz/api/send_email?template="+template+"&lang=en&email="+email, {
    method: 'GET'
  });
  console.log("The response is:");
  console.log(response);
  if(response.ok) {
    console.log("Response was ok, updating db");
    const insertQuery = sql`
      INSERT INTO subscriber (email, lastSentTemplate, Preferred_language, lastSentTime)
      VALUES (${email}, ${template}, 'en', timezone('CET', NOW()))
      ON CONFLICT (email) DO UPDATE
      SET lastSentTemplate = ${template},
          lastSentTime = timezone('CET', NOW())
      RETURNING id;
    `;
    const { rows } = await insertQuery;
    console.log("updated db!");
    console.log(rows);
  } else {
    console.log("Response was not ok!");
  }
}


async function sendWhatsappMessage() {
  try {
    const selectQuery = sql`
      SELECT * FROM subscriber;
    `;
    const { rows } = await selectQuery;
    for (const row of rows) {
      const lastSentTime = new Date(row.lastsenttime);
      const current_time = new Date();
      const twelveHoursAgo: Date = new Date(current_time.getTime() - 12 * 60 * 60 * 1000);

      if (!row.lastsenttime || lastSentTime < twelveHoursAgo) {
        console.log('Need to send message now!');
        const oldTemplate = row.lastsenttemplate.trim();
        console.log(oldTemplate);
        const template = getNextTemplate(oldTemplate, row.preferred_language);
        console.log(template);
        const message = getMessageForTemplateName(template);
        if(message.includes("Template not found") || template.includes("Template not found")) {
          console.log("Template not found!!!");
          continue;
        }

        if(row.email) {
          // email
          await sendNextEmail(row.email, template);
          continue;
        }

        console.log(row);
        const phone = row.phonenumber;
        console.log("inside sendWhatsappMessage");
        console.log(phone);
        console.log(template);
        console.log(message);
        const formData = new FormData();
        formData.append('From', "whatsapp:+13074486824");
        formData.append('To', "whatsapp:" + phone);
        formData.append('Body', message);
        const response = await fetch(`https://api.twilio.com/2010-04-01/Accounts/${accountSid}/Messages.json`, {
          method: 'POST',
          headers: {
            'Authorization': `Basic ${Buffer.from(`${accountSid}:${authToken}`).toString('base64')}`,
          },
          body: formData,
        });    
        if (response.ok) {
          const data = await response.json();
          console.log("data is:");
          console.log(data);
          console.log("test 3");
    
          const isEmail = /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(phone);
          let insertQuery;
          console.log("test 4");
    
          if(isEmail) {
            console.log("test 5");
            insertQuery = sql`
            INSERT INTO subscriber (email, lastSentTemplate, lastSentTime)
            VALUES (${phone}, ${template}, timezone('CET', NOW()))
            ON CONFLICT (email) DO UPDATE
            SET lastSentTemplate = ${template},
            lastSentTime = timezone('CET', NOW())
              RETURNING id;
          `;
          } else {
            console.log("test 6");
            insertQuery = sql`
            INSERT INTO subscriber (phoneNumber, lastSentTemplate, lastSentTime)
            VALUES (${phone},  ${template}, timezone('CET', NOW()))
            ON CONFLICT (phoneNumber) DO UPDATE
            SET lastSentTemplate = ${template},
            lastSentTime = timezone('CET', NOW())
              RETURNING id;
          `;
          }
          console.log("test 7");
          const { rows } = await insertQuery;
          console.log("test 8");
          const insertedSubscriberId = rows[0].id;
          console.log("test 9");
          console.log("subscriber id:"+ insertedSubscriberId);
        } else {
          console.error("Fetch request failed with status " + response.status);
          console.error(response.body);
          console.error(response);
          console.error(formData);
        }
      } else {
      }

    }

  } catch (error) {
    console.error("An error occurred:", error);
  }
}


const handler = async (req: Request): Promise<Response> => {
  try {
    // Get query parameters from the request
    await sendWhatsappMessage();
    return new Response("Sent!!!");
  } catch (error) {
    console.error(error);
    return new Response("Error", { status: 500 });
  }
};

export default handler;
